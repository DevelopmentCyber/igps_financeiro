<!doctype html>
<html lang="pt">
	<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>IGPS</title>
		
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
		<style>
			input {
				width: 100%;
			}
			table {
				width: 100%;
			}
			td {
				padding: 10px;
				border-bottom: 1px solid black;
			}
			th {
				padding: 10px;
				background-color: #259;
				color: white
			}
			input#botao {
				width: 30%;
			}
			body {
				padding: 20px;
			}
			div {
				border: 1px;
			}
		</style>
	</head>
	<body>
		<!--<a href="/imprimir_recibo/{{ os }}/">Recibo</a>-->
		<div style="width: 100%;">
			<div style="float: left; width: 20%; padding: 5px">
				<img src="/static/assets/igps.png" style="width: 90%;" alt="">
			</div>
			<div style="float: left; width: 80%">
				<h2><b>Relatório financeiro - DESPESAS</b></h2>
				Emissão: 
				<script>
					agora = new Date();
					document.write(agora.getDate() + '/' + String(agora.getMonth() + 1) + '/' + agora.getFullYear() + ' às ' + agora.getHours() + ':' + agora.getMinutes())
				</script>
				|
				Emitido pelo sistema do IGPS <br>
				INSTITUTO DE GESTÃO DE POLÍTICAS PÚBLICAS SOCIAIS - IGPS <br> <b>CNPJ:</b> 05.954.802/0001-54 <b>Sediado:</b> R JOSE ALVES DO COUTO 04, QUADRAK, QUILOMBO DOS PALMARES I, PALMARES - PE
				<br><br>
			</div>
			<br><br>
		</div>
		<br><br>
		<h3><b>Dados gerais</b></h3>
		<script>
			valor = 0;
			pagamentos_efetivados = 0;
			pagamentos_nao_efetivados = 0;
		</script>
		<b>Valor total de despesas: </b>R$ <i style="border: none; width: 40%;" disabled type="text" id="valor"></i>
		<br>
		<b>Pagamentos ainda não confirmados: </b>R$ <i style="border: none; width: 40%;" disabled type="text" id="pagamentos_nao_efetivados"></i>
		<br>
		<b>Pagamentos ainda confirmados: </b>R$ <i style="border: none; width: 40%;" disabled type="text" id="pagamentos_efetivados"></i>
		<br>
		<b>Usuário emissor: </b>{{ usuario }}
		<br>
		<b>ID do log de emissão: </b>{{ cod }}
		<br><br>
		{% if x == 1 %}
		<h3>
			<br><br>
			<b>Gráficos das principais despesas</b>
			<br><br>
		</h3>
		<script>
		emprestimo = 0
		veiculo = 0
		limpeza = 0
		expediente = 0
		agua_encanada = 0
		agua_mineral = 0
		energia = 0
		aluguel = 0
		seguro = 0
		vigilancia = 0
		telefone = 0
		contador = 0
		ferias = 0
		folha = 0
		prestacao = 0
		encargos = 0
		alimentacao = 0
		outros = 0
		</script>
		{% for d in despesas %}
			<script>
				if ('{{ d.descricao }}' == "Emprestimos") {
					emprestimo = Number.parseFloat(emprestimo) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Despesas com veículos (Que estiverem em nome da empresa/ou contrato de locação)") {
					veiculo = Number.parseFloat(veiculo) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Material Limpeza") {
					limpeza = Number.parseFloat(limpeza) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Material Expediente") {
					expediente = Number.parseFloat(expediente) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Agua encanada") {
					agua_encanada = Number.parseFloat(agua_encanada) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Agua Mineral") {
					agua_mineral = Number.parseFloat(agua_mineral) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Energia") {
					energia = Number.parseFloat(energia) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Aluguel + IPTU") {
					aluguel = Number.parseFloat(aluguel) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Seguro Empresarial") {
					seguro = Number.parseFloat(seguro) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Vigilancia") {
					vigilancia = Number.parseFloat(vigilancia) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Telefone + Internet") {
					telefone = Number.parseFloat(telefone) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Contador") {
					contador = Number.parseFloat(contador) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Férias") {
					ferias = Number.parseFloat(ferias) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == 'Folha de pagamento') {
					folha = Number.parseFloat(folha) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Prestacao de servico") {
					prestacao = Number.parseFloat(prestacao) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Encargos da folha (FGTS/INSS)") {
					encargos = Number.parseFloat(encargos) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else if ('{{ d.descricao }}' == "Alimentacao") {
					alimentacao = Number.parseFloat(alimentacao) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				} else {
					outros = Number.parseFloat(outros) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
				}
			</script>
			{% endfor %}
			<br><br>
				<canvas id="descricaoSaidas"></canvas>
				<br><br>
				<canvas id="descricaoSaidas2"></canvas>
			{% endif %}
		<br>
		<h3>
			<b>Detalhamento</b>
		</h3>
		<br>
		<table>
			<tr>
				<th>ID</th>
				<th>Descrição contábil</th>
				<th>Destino</th>
				<th>Valor</th>
				<th>Data</th>
				<th></th>
			</tr>
			{% for d in despesas %}
				<script>
					valor = Number.parseFloat(valor) + (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
					document.getElementById('valor').textContent = valor.toFixed(2)
				</script>
				{% if d.nota_fatura == None or d.nota_fatura == '' %}
				<tr style="background-color: #808080">
					<td>{{ d.id }}</td>
					<td>{{ d.descricao }}</td>
					<td>{{ d.vinculo }}</td>
					<td>{{ d.valor }}</td>
					<td>{{ d.data }}</td>
					<td>(Aguardando pagamento ser efetivado)</td>
					<script>
						pagamentos_nao_efetivados = pagamentos_nao_efetivados +  (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
						document.getElementById('pagamentos_nao_efetivados').textContent = pagamentos_nao_efetivados.toFixed(2)
					</script>
				</tr>
				{% else %}
				<tr>
					<td>{{ d.id }}</td>
					<td>{{ d.descricao }}</td>
					<td>{{ d.vinculo }}</td>
					<td>{{ d.valor }}</td>
					<td>{{ d.data }}</td>
					<td></td>
					<script>
						pagamentos_efetivados = pagamentos_efetivados +  (Number.parseFloat('{{ d.valor }}'.replace('.', '').replace('.', '').replace('.', '').replace(',', '.')))
						document.getElementById('pagamentos_efetivados').textContent = pagamentos_efetivados.toFixed(2)
					</script>
				</tr>
				{% endif %}
			{% endfor %}
		</table>
		<br><br>
		<br><br>

		<div style="width: 100%;">
			<div style="float: left">
				____________________________________________________________________<br>
				<b>{{ usuario }}</b>
			</div>
			<br><br>
		</div>
	<br>
	<br>
	<!-- Jquery JS-->
    <script src="https://www.devcyber.com/static/static/vendor/jquery-3.2.1.min.js"></script>
    <!-- Bootstrap JS-->
    <script src="https://www.devcyber.com/static/static/vendor/bootstrap-4.1/popper.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/bootstrap-4.1/bootstrap.min.js"></script>
    <!-- Vendor JS       -->
    <script src="https://www.devcyber.com/static/static/vendor/slick/slick.min.js">
    </script>
    <script src="https://www.devcyber.com/static/static/vendor/wow/wow.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/animsition/animsition.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/bootstrap-progressbar/bootstrap-progressbar.min.js">
    </script>
    <script src="https://www.devcyber.com/static/static/vendor/counter-up/jquery.waypoints.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/counter-up/jquery.counterup.min.js">
    </script>
    <script src="https://www.devcyber.com/static/static/vendor/circle-progress/circle-progress.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/chartjs/Chart.bundle.min.js"></script>
    <script src="https://www.devcyber.com/static/static/vendor/select2/select2.min.js">
    </script>
    <script>
        var ctx = document.getElementById("descricaoSaidas");

        var tiposChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ["Emprestimos", "Despesas com veículos (Que estiverem em nome da empresa/ou contrato de locação)", "Material Limpeza", "Material Expediente", "Agua encanada", "Agua Mineral", "Energia", "Aluguel + IPTU", "Seguro Empresarial", "Vigilancia", "Telefone + Internet", "Contador", "Férias", 'Folha de pagamento', "Prestacao de servico", "Encargos da folha (FGTS/INSS)", "Alimentacao", "Outros"],
                datasets: [{
                    label: 'Tipos',
                    data: [emprestimo, veiculo, limpeza, expediente, agua_encanada, agua_mineral, energia, aluguel, seguro, vigilancia, telefone, contador, ferias, folha, prestacao, encargos, alimentacao, outros],
                    backgroundColor: [
						'blue',
						'rgb(210, 165, 0)',
						'rgb(20, 255, 190)',
						'red',
						'yellow',
						'#259',
						'#808080',
						'green',
						'white',
						'#D3D3',
						'rgb(100%, 20%, 300%)',
						'rgb(0%, 70%, 30%)',
						'rgb(0%, 100%, 40%)',
						'rgb(60%, 50%, 20%)',
						'rgb(20%, 70%, 90%)',
						'rgb(70%, 90%, 20%)',
						'orange',
						'#259',
						'rgb(200, 255, 100)',
						'rgb(70, 240, 255)',
						'black'
                ],
                borderColor: [
					'yellow',
                    'orange',
                    'orangered',
					'red',
                    'yellow',
                    'orange',
                    'orangered',
					'red',
                    'yellow',
                    'orange',
                    'orangered',
					'red',
                    'yellow',
                    'orange',
                    'orangered',
					'red',
					'yellow',
                    'orange',
                    'orangered',
					'red',
                    'green'
                ],
                    borderWidth: 1
                }] 
            },
            
        });
    </script>
	<script>
	var ctx = document.getElementById("descricaoSaidas2");

	var tiposChart = new Chart(ctx, {
		type: 'pie',
		data: {
			labels: ["Emprestimos", "Despesas com veículos (Que estiverem em nome da empresa/ou contrato de locação)", "Material Limpeza", "Material Expediente", "Agua encanada", "Agua Mineral", "Energia", "Aluguel + IPTU", "Seguro Empresarial", "Vigilancia", "Telefone + Internet", "Contador", "Férias", 'Folha de pagamento', "Prestacao de servico", "Encargos da folha (FGTS/INSS)", "Alimentacao", "Outros"],
			datasets: [{
				label: 'Tipos',
				data: [emprestimo, veiculo, limpeza, expediente, agua_encanada, agua_mineral, energia, aluguel, seguro, vigilancia, telefone, contador, ferias, folha, prestacao, encargos, alimentacao, outros],
				backgroundColor: [
					'blue',
					'rgb(210, 165, 0)',
					'rgb(20, 255, 190)',
					'red',
					'yellow',
					'#259',
					'#808080',
					'green',
					'white',
					'#D3D3',
					'rgb(100%, 20%, 300%)',
					'rgb(0%, 70%, 30%)',
					'rgb(0%, 100%, 40%)',
					'rgb(60%, 50%, 20%)',
					'rgb(20%, 70%, 90%)',
					'rgb(70%, 90%, 20%)',
					'orange',
					'#259',
					'rgb(200, 255, 100)',
					'rgb(70, 240, 255)',
					'black'
			],
			borderColor: [
				'yellow',
				'orange',
				'orangered',
				'red',
				'yellow',
				'orange',
				'orangered',
				'red',
				'yellow',
				'orange',
				'orangered',
				'red',
				'yellow',
				'orange',
				'orangered',
				'red',
				'yellow',
				'orange',
				'orangered',
				'red',
				'green'
			],
				borderWidth: 1
			}] 
		},
		
	});

</script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>
	<script>
		$(document).ready(function(){
			$('i[id=valor]').mask('0.000.000.000.000,00', {reverse: true});
			$('i[id=pagamentos_nao_efetivados]').mask('0.000.000.000.000,00', {reverse: true});
			$('i[id=pagamentos_efetivados]').mask('0.000.000.000.000,00', {reverse: true});
		});
		document.addEventListener("DOMContentLoaded", function(event) {
			window.print();
		});
	</script>
	</body>
</html>